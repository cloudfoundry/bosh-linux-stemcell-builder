@@ -22,8 +22,8 @@
 # pam-auth-update(8) for details.

 # here are the per-package modules (the "Primary" block)
-password	requisite			pam_pwquality.so retry=3
-password	[success=1 default=ignore]	pam_unix.so obscure use_authtok try_first_pass yescrypt
+password	requisite			pam_pwquality.so retry=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 difok=8
+password	[success=1 default=ignore]	pam_unix.so obscure use_authtok try_first_pass sha512 remember=24 minlen=14 rounds=5000
 # here's the fallback if no module succeeds
 password	requisite			pam_deny.so
 # prime the stack with a positive return value if there isn't one already;
@@ -31,4 +31,5 @@
 # since the modules above will each just jump around
 password	required			pam_permit.so
 # and here are more per-package modules (the "Additional" block)
+# session	required			pam_lastlog.so showfailed #NOBLE_TODO: Commented out when pam_lastlog is availble again
 # end of pam-auth-update config
